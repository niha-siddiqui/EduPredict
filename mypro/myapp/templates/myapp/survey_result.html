{% extends "master.html"%}
{% block lala %}

<section class="features" style="background-color: #0c1228; padding: 100px 0;">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-md-11">

        <!-- Result Card -->
        <div id="progressCard" style="background: linear-gradient(135deg, rgba(22,34,57,0.95) 0%, rgba(12,18,40,0.98) 100%); padding: 60px; border-radius: 10px; box-shadow: 0px 10px 50px rgba(0,0,0,0.5); border: 1px solid rgba(245,164,37,0.1); position: relative; overflow: hidden;">

          <!-- Decorative Elements -->
          <div style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: radial-gradient(circle, rgba(245,164,37,0.1) 0%, transparent 70%); border-radius: 50%;"></div>
          <div style="position: absolute; bottom: -30px; left: -30px; width: 150px; height: 150px; background: radial-gradient(circle, rgba(245,164,37,0.08) 0%, transparent 70%); border-radius: 50%;"></div>

          <!-- Header Section -->
          <div style="text-align: center; margin-bottom: 50px; position: relative; z-index: 1;">
            <div style="display: inline-block; background: linear-gradient(135deg, #f5a425 0%, #ff8800 100%); width: 90px; height: 90px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 25px; box-shadow: 0 8px 25px rgba(245,164,37,0.4);">
              <i class="fa fa-trophy" style="font-size: 40px; color: #fff;"></i>
            </div>
            <h2 style="color: #fff; font-size: 36px; font-weight: 800; letter-spacing: 1px; margin-bottom: 15px; text-transform: uppercase;">
              Your Personality <span style="color: #f5a425;">Report</span>
            </h2>
            <div style="width: 80px; height: 3px; background: linear-gradient(90deg, transparent, #f5a425, transparent); margin: 20px auto;"></div>
            <p style="color: rgba(255,255,255,0.7); font-size: 15px;">
              Survey analysis completed successfully
            </p>
          </div>

          <!-- Score Display -->
          <div style="background: rgba(245,164,37,0.05); padding: 40px; border-radius: 8px; margin-bottom: 40px; text-align: center; border: 2px solid rgba(245,164,37,0.2); position: relative; z-index: 1;">
            <h3 style="color: rgba(255,255,255,0.8); font-size: 16px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px;">
              <i class="fa fa-star" style="color: #f5a425; margin-right: 10px;"></i>Your Overall Score
            </h3>
            <div style="font-size: 72px; font-weight: 800; color: #f5a425; margin-bottom: 10px; text-shadow: 0 0 30px rgba(245,164,37,0.5);">
              {{ score }}%
            </div>

            <!-- Score Bar -->
            <div style="width: 100%; max-width: 500px; height: 20px; background: rgba(250,250,250,0.1); border-radius: 10px; margin: 20px auto; overflow: hidden; position: relative;">
              <div style="width: {{ score }}%; height: 100%; background: linear-gradient(90deg, #f5a425 0%, #ff8800 100%); border-radius: 10px; box-shadow: 0 0 20px rgba(245,164,37,0.6); transition: width 1s ease;"></div>
            </div>
          </div>

          <!-- Personality Report Section -->
          <div style="background: rgba(245,164,37,0.03); padding: 40px; border-radius: 8px; margin-bottom: 30px; border-left: 4px solid #4bc0c0; position: relative; z-index: 1;">
            <h3 style="color: #4bc0c0; font-size: 20px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 25px;">
              <i class="fa fa-user" style="margin-right: 10px;"></i>Academic & Personality Analysis
            </h3>

            <div style="background: rgba(250,250,250,0.02); padding: 30px; border-radius: 8px; border: 1px solid rgba(250,250,250,0.05);">
              <p style="color: rgba(255,255,255,0.85); font-size: 15px; line-height: 32px; margin: 0; text-align: justify; letter-spacing: 0.3px;">
                {{ paragraph }}
              </p>
            </div>
          </div>

          <!-- Motivational Quote Section -->
          <div style="background: linear-gradient(135deg, rgba(245,164,37,0.1) 0%, rgba(245,164,37,0.05) 100%); padding: 40px; border-radius: 8px; margin-bottom: 40px; border-left: 4px solid #f5a425; position: relative; z-index: 1; text-align: center;">
            <div style="margin-bottom: 20px;">
              <i class="fa fa-quote-left" style="font-size: 32px; color: rgba(245,164,37,0.4);"></i>
            </div>

            <h3 style="color: #f5a425; font-size: 18px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 25px;">
              <i class="fa fa-lightbulb-o" style="margin-right: 10px;"></i>Motivational Message For You
            </h3>

            <p style="color: rgba(255,255,255,0.9); font-size: 18px; line-height: 34px; margin: 0; font-style: italic; font-weight: 500; letter-spacing: 0.5px;">
              "{{ quote }}"
            </p>

            <div style="margin-top: 20px;">
              <i class="fa fa-quote-right" style="font-size: 32px; color: rgba(245,164,37,0.4);"></i>
            </div>
          </div>

          <!-- Strengths & Recommendations Grid -->
          <div class="row" style="position: relative; z-index: 1; margin-bottom: 30px;">
            <!-- Your Strengths -->
            <div class="col-md-6" style="margin-bottom: 30px;">
              <div style="background: rgba(75,192,192,0.08); padding: 30px; border-radius: 8px; border-left: 4px solid #4bc0c0; height: 100%;">
                <h4 style="color: #4bc0c0; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px;">
                  <i class="fa fa-check-circle" style="margin-right: 10px;"></i>Key Strengths
                </h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-star" style="position: absolute; left: 0; top: 13px; color: #4bc0c0;"></i>
                    Strong analytical thinking
                  </li>
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-star" style="position: absolute; left: 0; top: 13px; color: #4bc0c0;"></i>
                    Good learning adaptability
                  </li>
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-star" style="position: absolute; left: 0; top: 13px; color: #4bc0c0;"></i>
                    Positive academic attitude
                  </li>
                </ul>
              </div>
            </div>

            <!-- Next Steps -->
            <div class="col-md-6" style="margin-bottom: 30px;">
              <div style="background: rgba(245,164,37,0.08); padding: 30px; border-radius: 8px; border-left: 4px solid #f5a425; height: 100%;">
                <h4 style="color: #f5a425; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px;">
                  <i class="fa fa-bullseye" style="margin-right: 10px;"></i>Next Steps
                </h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-arrow-right" style="position: absolute; left: 0; top: 13px; color: #f5a425;"></i>
                    Explore recommended courses
                  </li>
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-arrow-right" style="position: absolute; left: 0; top: 13px; color: #f5a425;"></i>
                    Connect with academic advisor
                  </li>
                  <li style="color: rgba(255,255,255,0.8); font-size: 14px; line-height: 26px; padding: 10px 0; padding-left: 25px; position: relative;">
                    <i class="fa fa-arrow-right" style="position: absolute; left: 0; top: 13px; color: #f5a425;"></i>
                    Join study groups matching your style
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div style="text-align: center; margin-top: 45px; position: relative; z-index: 1;">
            <a href="{% url 'student_survey' %}" style="display: inline-block; background: linear-gradient(135deg, #f5a425 0%, #ff8800 100%); color: #fff; font-size: 15px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; padding: 20px 50px; border: none; outline: none; text-decoration: none; transition: all 0.4s; border-radius: 50px; box-shadow: 0px 8px 30px rgba(245,164,37,0.4); margin: 0 10px 10px 10px;">
              <i class="fa fa-refresh" style="margin-right: 12px;"></i>Take Survey Again
            </a>
            <a href="/" style="display: inline-block; background: transparent; color: #f5a425; font-size: 15px; text-transform: uppercase; letter-spacing: 1.5px; font-weight: 700; padding: 20px 50px; border: 2px solid #f5a425; outline: none; text-decoration: none; transition: all 0.4s; border-radius: 50px; margin: 0 10px 10px 10px;">
              <i class="fa fa-home" style="margin-right: 12px;"></i>Back to Home
            </a>
          </div>

          <!-- PDF Download Button -->
          <div style="text-align: center; margin-top: 25px;">
            <button onclick="downloadPDF()" style="background: linear-gradient(135deg, #f5a425 0%, #ff8800 100%); color: #fff; padding: 15px 40px; font-weight: bold; border-radius: 50px; border: none; cursor: pointer;">
              <i class="fa fa-download" style="margin-right: 8px;"></i>Download PDF
            </button>
          </div>

          <!-- Info Note -->
          <div style="margin-top: 45px; padding: 25px 30px; background: linear-gradient(135deg, rgba(245,164,37,0.08) 0%, rgba(245,164,37,0.03) 100%); border-left: 4px solid #f5a425; border-radius: 8px; position: relative; z-index: 1;">
            <div style="display: flex; align-items: flex-start;">
              <i class="fa fa-info-circle" style="color: #f5a425; font-size: 24px; margin-right: 18px; margin-top: 3px;"></i>
              <div>
                <h5 style="color: #f5a425; font-size: 14px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; margin-bottom: 10px;">
                  About Your Results
                </h5>
                <p style="color: rgba(255,255,255,0.75); font-size: 13px; line-height: 24px; margin: 0;">
                  This analysis is based on your survey responses and is designed to help you understand your learning preferences and personality traits. Use these insights to enhance your academic journey and personal growth.
                </p>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>
</section>

<!-- PDF Script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
function downloadPDF() {
    const report = document.getElementById("progressCard");

    html2canvas(report, { scale: 2 }).then((canvas) => {
        const imgData = canvas.toDataURL("image/png");

        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF("p", "mm", "a4");

        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        const imgWidth = pageWidth;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft > 0) {
            position = heightLeft - imgHeight;
            pdf.addPage();
            pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;
        }

        pdf.save("Student_Survey_Report.pdf");
    }).catch(err => {
        console.error("PDF generation failed:", err);
    });
}
</script>

{% endblock %}
